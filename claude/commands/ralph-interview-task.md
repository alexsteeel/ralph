---
name: ralph-interview-task
description: Interview user in-depth to create a detailed spec for task
arguments:
  - name: task_ref
    description: Task reference in format "project#N" (e.g., "myproject#18")
    required: true
allowed-tools: AskUserQuestion, Read, Glob, Grep, mcp__md-task-mcp__get_task, mcp__md-task-mcp__update_task, mcp__md-task-mcp__tasks
---

Ты проводишь ДЕТАЛЬНОЕ ИНТЕРВЬЮ для создания спецификации задачи.

## Цель

Провести глубокое интервью с пользователем, чтобы собрать ВСЮ необходимую информацию для создания детальной спецификации. После интервью — записать спецификацию в задачу.

## Принципы

- **Глубина важнее скорости** — не торопись, задавай уточняющие вопросы
- **Не предполагай** — если что-то неясно, спроси
- **Не пропускай детали** — технические, UX, edge cases, trade-offs
- **Используй контекст проекта** — читай код и документацию для релевантных вопросов

## Входные данные

Task reference: `$ARGUMENTS`

## Workflow

### Phase 0: Get Task

Получи задачу через md-task-mcp.

### Phase 1: Context Gathering

**Перед интервью** изучи контекст:

1. **Документация проекта**:
   - CLAUDE.md — правила разработки
   - README.md — структура проекта

2. **Связанный код** (если module указан):
   - Найди существующие файлы модуля
   - Пойми текущую архитектуру
   - Определи паттерны проекта

3. **Связанные задачи**:
   ```python
   tasks(project="<project>")
   ```
   - Есть ли зависимости?
   - Есть ли похожие завершённые задачи (можно взять как референс)?

### Phase 2: Deep Interview

**Используй AskUserQuestion** для детального интервью.

Покрой все релевантные темы:
- Функциональные требования
- Технические решения и архитектура
- UI/UX (если применимо)
- Edge cases и error handling
- Безопасность и производительность
- Тестирование
- Trade-offs и приоритеты

### Правила

- **Задавай столько вопросов, сколько нужно** — можно много за раз, если все по делу
- **Не задавай очевидных вопросов** — используй контекст проекта
- **Адаптируйся** — углубляйся в темы по мере ответов
- **В конце подтверди понимание** — перескажи ключевые решения

### Phase 3: Write Specification

После интервью дополни `body` задачи детальной спецификацией через `update_task()`.

Включи все собранные требования, решения, edge cases и acceptance criteria.

### Phase 4: Report

```
✅ ИНТЕРВЬЮ ЗАВЕРШЕНО

Задача: {project}#{number} - {title}

Спецификация записана в задачу.

Следующие шаги:
1. Планирование: /ralph-plan-task {project}#{number}
2. Реализация: /ralph-implement-python-task {project}#{number}
```

## Checklist

- [ ] Задача получена
- [ ] Контекст проекта изучен
- [ ] Функциональные требования уточнены
- [ ] Технические решения согласованы
- [ ] UI/UX обсуждён (если применимо)
- [ ] Edge cases покрыты
- [ ] Error handling определён
- [ ] Требования к тестированию собраны
- [ ] Trade-offs обсуждены
- [ ] Спецификация записана в задачу
